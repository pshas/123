# 123
123
Проблема с тем, что модальное окно открывается до нажатия кнопки "Оформить", может быть вызвана тем, что код, отвечающий за открытие модального окна, выполняется раньше, чем ожидается.

Для корректной работы нужно убедиться, что вызов функции `openSubmitModal()` происходит только при нажатии на кнопку "Оформить". Проверьте, как в таблице генерируются кнопки "Оформить", и как к ним привязывается функция JavaScript.

### 1. Правильное генерирование кнопки "Оформить" в PHP

В таблице нужно создать кнопку, которая при нажатии передает ID шаблона в функцию `openSubmitModal()`. Например:

```php
echo "<td>
        <button class='btn btn-success btn-sm' onclick='openSubmitModal(" . $row['id'] . ")'>Оформить</button>
      </td>";
```

Убедитесь, что кнопка создается правильно и передает ID шаблона (в данном случае `$row['id']`).

### 2. Скрипт для открытия модального окна

Вот исправленный JavaScript-код, который должен срабатывать только при нажатии кнопки "Оформить":

```html
<script>
// Функция для открытия модального окна и передачи ID шаблона
function openSubmitModal(templateId) {
    // Устанавливаем значение ID шаблона в скрытое поле формы
    document.getElementById('templateId').value = templateId;
    
    // Открываем модальное окно только по нажатию кнопки
    $('#submitModal').modal('show');
}

// Убедитесь, что функция не вызывается сразу, а только при нажатии кнопки
</script>
```

### Что проверить:

1. **Обработчик события**: Функция `openSubmitModal()` должна быть вызвана только при нажатии на кнопку "Оформить". Проверьте, нет ли у вас ошибок, которые вызывают её сразу при загрузке страницы.
   
2. **Очистка кеша**: Иногда браузер может кэшировать старую версию скрипта. Попробуйте очистить кэш браузера или открыть страницу в режиме инкогнито.

3. **HTML-события**: Убедитесь, что никаких других JavaScript-событий, таких как автоматический вызов функции, не привязывается к кнопке "Оформить".

После этого, модальное окно должно открываться только при нажатии на соответствующую кнопку.
